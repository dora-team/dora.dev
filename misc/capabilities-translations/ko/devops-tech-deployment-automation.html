<html devsite><head><meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />
    <title>DevOps 테크: 배포 자동화</title>
    <meta name="book_path" value="/architecture/devops/_book.yaml"/>
    <meta name="project_path" value="/architecture/devops/_project.yaml"/>
    <meta name="translation_service" value="machine_translation_light_post_edit"/>
  </head>
  <body>

<aside class="note"><strong>참고:</strong><span> <em>배포 자동화</em>는 소프트웨어 제공 및 조직 성과 향상을 가져오는 기능 집합 중 하나입니다. 이러한 기능은 성과 향상을 이끌어내는 관례와 기능을 독립적이자 학술적으로 심층 연구하는 <a href="https://www.devops-research.com/research.html">DORA State of DevOps 연구 프로그램</a>을 통해 개발되었습니다. 자세한 내용은 <a href="/devops">DevOps 리소스</a>를 참조하세요.</span></aside>
<p>배포 자동화란 버튼만 누르면 테스트 및 프로덕션 환경에 소프트웨어를 배포할 수 있는 것을 말합니다. 프로덕션 배포의 위험을 줄이기 위해 자동화는 필수적입니다. 또한 변경 후 팀이 최대한 빨리 포괄적인 테스트를 수행할 수 있도록 함으로써 소프트웨어 품질에 대한 빠른 피드백을 제공하는 데도 필수적입니다.</p>

<p>자동 배포 프로세스의 투입은 다음과 같습니다.</p>

<ul>
<li>지속적 통합(CI) 프로세스에 의해 생성된 패키지(이 패키지는 프로덕션을 포함한 모든 환경에 배포할 수 있어야 합니다).</li>
<li>환경을 구성하고 패키지를 배포하고 배포 테스트(경우에 따라 <em>스모크 테스트</em>라고 함)를 수행하는 스크립트.</li>
<li>환경별 구성 정보.</li>
</ul>

<p>버전 제어에 스크립트 및 구성 정보를 저장하는 것이 좋습니다. 배포 프로세스는 <a href="/artifact-registry" track-type="article" track-name="internalLink" track-metadata-position="body">Artifact Registry</a>, <a href="https://www.sonatype.com/nexus-repository-sonatype" target="external" track-type="article" track-name="externalLink" track-metadata-position="body" class="external">Nexus</a>, <a href="https://jfrog.com/artifactory/" target="external" track-type="article" track-name="externalLink" track-metadata-position="body" class="external">Artifactory</a> 또는 CI 도구의 기본 제공 저장소와 같은 아티팩트 저장소에서 패키지를 다운로드해야 합니다.</p>

<p>일반적으로 스크립트는 다음 작업을 수행합니다.</p>

<ol>
<li>필요한 소프트웨어를 설치 및 구성하거나 Google Cloud와 같은 클라우드 제공업체의 미리 준비된 이미지에서 가상 호스트를 시작하여 대상 환경을 준비합니다.</li>
<li>패키지를 배포합니다.</li>
<li>데이터베이스 마이그레이션 스크립트 실행과 같은 모든 배포 관련 태스크를 수행합니다.</li>
<li>필요한 구성을 수행합니다.</li>
<li>배포 테스트를 수행하여 필요한 외부 서비스에 연결할 수 있고 시스템이 제대로 작동하는지 확인합니다.</li>
</ol>

<h2 id="how_to_implement_deployment_automation" data-text="배포 자동화 구현 방법">배포 자동화 구현 방법</h2>

<p>자동 배포 프로세스를 설계할 때 다음 권장사항을 따르는 것이 좋습니다.</p>

<ul>
<li><strong>프로덕션을 포함한 모든 환경에 동일한 배포 프로세스를 사용합니다.</strong> 이 규칙을 사용하면 프로덕션 배포에 사용하기 전에 배포 프로세스를 여러 번 테스트할 수 있습니다.</li>
<li><strong>필요한 사용자 인증 정보가 있다면 누구나 필요할 때 모든 버전의 아티팩트를 모든 환경에 완전 자동 배포하도록 허용합니다.</strong>
티켓을 만들고 누군가가 환경을 준비할 때까지 기다려야 한다면 완전 자동 배포 프로세스가 없는 것입니다.</li>
<li><strong>모든 환경에 동일한 패키지를 사용합니다.</strong> 이 규칙은 환경별 구성을 패키지와 별도로 유지해야 함을 의미합니다.
이렇게 하면 프로덕션에 배포하는 패키지가 테스트한 패키지와 동일함을 알 수 있습니다.</li>
<li><strong>버전 제어에 저장된 정보로 모든 환경의 상태를 다시 만들 수 있어야 합니다.</strong> 이 규칙을 사용하면 배포를 반복할 수 있으며 재해 복구 시나리오가 발생하는 경우 명확하게 프로덕션 상태를 복원할 수 있습니다.</li>
</ul>

<p>배포에 자율적으로 사용할 수 있는 도구, 현재 각 환경에 있는 빌드를 기록하는 도구, 감사 용도로 배포 프로세스의 출력을 기록하는 도구가 있으면 좋습니다. 많은 CI 도구에는 이러한 기능이 있습니다.</p>

<h2 id="common_pitfalls_in_deployment_automation" data-text="배포 자동화의 일반적인 문제">배포 자동화의 일반적인 함정</h2>

<p>배포 프로세스를 자동화할 때 다음과 같은 함정에 빠질 수 있습니다.</p>

<ul>
<li>기존 프로세스의 복잡성</li>
<li>서비스 간 종속 항목</li>
<li>자동화를 위해 설계되지 않은 구성요소</li>
<li>팀 간 공동작업 미흡</li>
</ul>

<h3 id="complexity" data-text="복잡성">복잡성</h3>

<p>첫 번째 함정은 복잡성입니다. 복잡하고 취약한 수동 프로세스를 자동화하면 복잡하고 취약한 자동 프로세스가 생성됩니다. 먼저 배포할 수 있도록 아키텍처를 재설계해야 합니다. 즉, 배포 스크립트를 최대한 단순하게 만들고 복잡성은 애플리케이션 코드와 인프라 플랫폼에 밀어 넣어야 합니다. 배포 실패 모드를 찾고 서비스, 구성요소, 인프라 플랫폼, 모니터링을 어떻게 더 스마트하게 만들면 실패를 피할 수 있는지 물어보세요. <a href="/appengine" track-type="article" track-name="internalLink" track-metadata-position="body">App Engine</a>, <a href="/run" track-type="article" track-name="internalLink" track-metadata-position="body">Cloud Run</a> 또는 <a href="/architecture/cloud-foundry-on-gcp" track-type="article" track-name="internalLink" track-metadata-position="body">Pivotal Cloud Foundry</a>와 같은 PaaS(Platform-as-a-Service)에서 실행되는 클라우드 기반 애플리케이션은 일반적으로 단일 명령어를 사용하여 배포할 수 있으며, 배포 스크립트가 전혀 필요하지 않습니다. 이것이 이상적인 프로세스입니다.</p>

<p>안정적인 배포 프로세스에는 두 가지 중요한 속성이 있습니다. 첫째, 실패 시 필요한 만큼 여러 번 반복할 수 있도록 배포 프로세스의 개별 단계는 최대한 멱등적이어야 합니다. 둘째, 순서와 독립적이어야 합니다. 즉, 구성요소 또는 서비스는 예상하는 다른 구성요소 또는 서비스가 없어도 비정상 종료되지 않아야 합니다. 대신 서비스는 종속 항목을 사용할 수 있을 때까지 저하된 방식으로 계속 작동해야 합니다.</p>

<p>새 제품 및 서비스의 경우 설계 단계 시작부터 이러한 원칙을 시스템 요구사항으로 취급하는 것이 좋습니다. 자동화를 기존 시스템에 추가하는 경우 배포 프로세스가 불일치 상태를 감지하고 정상적으로 실패할 수 있도록 이러한 특성을 구현하거나 원격 분석을 구축하기 위한 일부 작업을 수행해야 할 수 있습니다.</p>

<h3 id="dependencies" data-text="종속 항목">종속 항목</h3>

<p>두 번째 함정은 특히 엔터프라이즈 환경의 여러 배포 프로세스에는 조정이 필요하다는 것입니다. 즉, 엄격한 동기화로 데이터베이스 마이그레이션 같은 다른 태스크를 수행하면서 특정 순서로 여러 서비스를 함께 배포해야 합니다. 이러한 상황에 도움이 되는 엔터프라이즈 배포 워크플로 도구가 많지만 이러한 도구는 근본적으로 아키텍처 문제, 즉 다양한 구성요소와 서비스 간의 긴밀한 결합 문제의 미봉책에 불과합니다. 시간이 지남에 따라 이 긴밀한 결합 문제를 해결해야 합니다. 서비스는 조정이 필요없이 독립적인 배포가 가능해야 합니다.</p>

<p>일반적으로 이 방법을 사용하려면 잠금 단계에서는 서비스 클라이언트의 업그레이드가 필요하지 않지만 나중에 독립적으로 업그레이드할 수 있도록 각 서비스가 하위 호환성을 지원할 수 있는 신중한 설계가 필요합니다.
여기에는 <a href="/architecture/migrating-a-monolithic-app-to-microservices-gke#api_contracts" track-type="article" track-name="internalLink" track-metadata-position="body">API 버전 관리</a>와 같은 기술이 도움이 될 수 있습니다. 종속된 다른 서비스에 연결할 수 없는 경우에도 서비스가 계속 작동(일부 기능은 사용할 수 없겠지만)할 수 있도록 하는 것도 중요합니다. 이 설계는 단계식 오류 방지에 도움이 될 수 있기 때문에 분산 시스템에 적합합니다. Michael Nygard의 저서 'Release It!'에는 <a href="https://martinfowler.com/bliki/CircuitBreaker.html" target="external" track-type="article" track-name="externalLink" track-metadata-position="body" class="external">회로 차단기</a>를 포함하여 분산 시스템 설계에 도움이 되는 다양한 패턴이 설명되어 있습니다.
<a href="https://martinfowler.com/bliki/ParallelChange.html" target="external" track-type="article" track-name="externalLink" track-metadata-position="body" class="external">병렬 변경 패턴</a>을 사용하여 데이터베이스 업그레이드를 종속 서비스에서 분리할 수도 있습니다.</p>

<h3 id="not_designed_for_automation" data-text="자동화를 위해 설계되지 않음">자동화를 위해 설계되지 않음</h3>

<p>세 번째 일반적인 함정은 자동화를 위해 설계되지 않은 구성요소입니다. Console에 로그인하고 클릭을 통해 수동으로 상호작용해야 하는 배포 프로세스는 개선해야 합니다. 오늘날 Google Cloud를 비롯한 대부분의 플랫폼은 배포 스크립트에서 사용할 수 있는 API를 제공합니다. 그렇지 않다면 도구의 기본 구성 파일 또는 데이터베이스를 찾아 직접 변경하거나 API가 있는 다른 도구로 대체하는 등의 수동 개입을 피하기 위해 창의성을 발휘해야 합니다.</p>

<h3 id="poor_collaboration_between_teams" data-text="팀 간 공동작업 미흡">팀 간 공동작업 미흡</h3>

<p>마지막 함정은 개발팀과 IT 운영팀이 동기화되지 않을 때 발생합니다.
발생하는 방식에는 몇 가지가 있습니다. 예를 들어 개발팀과 IT 운영팀이 사용하는 배포 방법이 서로 다를 수 있습니다. 또 다른 예시로 환경이 각기 다르게 구성되면 IT 운영팀이 배포 프로세스를 수동으로 수행할 위험이 상당히 커지며, 이로 인해 불일치와 오류가 발생할 수 있습니다. 배포 자동화 프로세스는 개발팀과 IT 운영팀이 공동으로 만들어야 합니다. 이 방법을 통해 두 팀 모두 배포 자동화를 이해, 유지, 발전시킬 수 있습니다.</p>

<h2 id="ways_to_improve_deployment_automation" data-text="배포 자동화 개선 방법">배포 자동화 개선 방법</h2>

<p>첫 번째 단계는 Google 문서나 위키 등 개발팀과 운영팀이 액세스할 수 있는 공통 도구로 기존 배포 프로세스를 문서화하는 것입니다.
그런 다음 배포 프로세스를 점진적으로 간소화하고 자동화합니다. 이 방법에는 일반적으로 다음과 같은 작업이 포함됩니다.</p>

<ul>
<li>배포에 적합한 방식으로 코드를 패키징.</li>
<li>사전 구성된 가상 머신 이미지 또는 컨테이너 만들기.</li>
<li>미들웨어의 배포 및 구성 자동화.</li>
<li>패키지 또는 파일을 프로덕션 환경으로 복사.</li>
<li>서버, 애플리케이션 또는 서비스를 다시 시작.</li>
<li>템플릿에서 구성 파일 생성.</li>
<li>자동 배포 테스트를 실행하여 시스템이 작동하고 올바르게 구성되었는지 확인.</li>
<li>테스트 절차 실행.</li>
<li>데이터베이스 마이그레이션 스크립팅 및 자동화.</li>
</ul>

<p>가능하면 항상 수동 단계를 제거하고 멱등성 및 순서 독립성을 구현하려 노력하고, 가능하면 항상 인프라 플랫폼의 기능을 활용합니다. 배포 자동화는 최대한 간단해야 합니다.</p>

<h2 id="ways_to_measure_deployment_automation" data-text="배포 자동화를 측정하는 방법">배포 자동화를 측정하는 방법</h2>

<p>배포 자동화를 측정하는 것은 간단합니다.</p>

<ul>
<li><strong>배포 프로세스의 수동 단계 수를 계산합니다</strong>. 이러한 단계를 체계적으로 줄이기 위해 노력합니다. 수동 단계 수가 많을수록 배포 시간과 오류 가능성이 증가합니다.</li>
<li><strong>배포 파이프라인의 자동화 수준 또는 비율을 측정합니다</strong>. 이 수준을 지속적으로 높이기 위해 노력합니다.</li>
<li><strong>배포 파이프라인의 지연에 소요된 시간을 확인합니다</strong>. 이러한 지연을 줄이려 노력하면서 배포 파이프라인에서 코드가 멈추는 위치와 이유를 이해합니다.</li>
</ul>

<h2 id="whats_next" data-text="다음 단계">다음 단계</h2>

<ul>
<li>다른 문서 및 리소스 링크는 <a href="/devops" track-type="solution" track-name="internalLink" track-metadata-position="body">DevOps 페이지</a>를 참조하세요.</li>
<li>Google Cloud의 <a href="/solutions/continuous-delivery" track-type="solution" track-name="internalLink" track-metadata-position="body">지속적 배포 솔루션</a>에 대해 자세히 알아보세요.</li>
<li><a href="https://landing.google.com/sre/books/" target="external" track-type="article" track-name="externalLink" track-metadata-position="body">사이트 안정성 엔지니어링(SRE)</a>, 특히 <a href="https://landing.google.com/sre/sre-book/chapters/release-engineering/" target="external" track-type="article" track-name="externalLink" track-metadata-position="body">8장 - 출시 엔지니어링</a>을 읽어보세요.</li>
<li><a href="http://www.informit.com/articles/article.aspx?p=1833567" target="external" track-type="article" track-name="externalLink" track-metadata-position="body" class="external">저위험 소프트웨어 릴리스의 4가지 원칙</a>을 읽어보세요.</li>
<li>DevOps <a href="https://www.devops-research.com/research.html">연구 프로그램</a>을 살펴보세요.</li>
<li><a href="https://www.devops-research.com/quickcheck.html">DevOps 빠른 점검</a>을 사용하여 업계와 비교되는 자신의 현재 상태를 파악하세요.</li>
</ul>

</body></html>