{{ define "main" }}
<!-- TODO: #121 make a partial to process scss files and render <link> tags -->
{{ $stylesheet := printf "scss/research.scss" | resources.Get | toCSS | fingerprint }}
<link rel="stylesheet" href="{{ $stylesheet.RelPermalink }}" integrity="{{ $stylesheet.Data.Integrity }}">

<script defer src="https://www.gstatic.com/charts/loader.js"></script>
<!-- TODO: #189 make a partial to process javascript assets and render a `script` tag -->
{{- $research := resources.Get "js/research.js" -}}
{{- $jsFiles := slice $research }}
{{- $jsBundle := $jsFiles | resources.Concat "js/research" | fingerprint -}}
<script defer src="{{ $jsBundle.RelPermalink }}" integrity="{{ $jsBundle.Data.Integrity }}" defer></script>

<section class="hasSidebar">
    <article>
        {{ .Content }}
    </article>
    <sidebar>
        {{ partial "research_sidebar.html" . }}
    </sidebar>
    <div class="double-wide bfd-container">
        <script src="https://www.gstatic.com/glue/v20_0/glue-detect.min.js"></script>
        <script src="https://d3js.org/d3.v5.min.js"></script>
        <div class="text-left">
            <div id="bfd"></div>
            <svg id="key" width="100%" height="170">
                <text x="5" y="15" class="bfd-title">Key</text>
                <circle r="5" cx="15" cy="30" class="bfd-circle cultural"></circle>
                <text x="40" y="35" class="bfd-text">Cultural capability</text>
                <circle r="5" cx="15" cy="50" class="bfd-circle process"></circle>
                <text x="40" y="55" class="bfd-text">Product and process capability</text>
                <circle r="5" cx="15" cy="70" class="bfd-circle management"></circle>
                <text x="40" y="75" class="bfd-text">Lean management and monitoring capability</text>
                <circle r="5" cx="15" cy="90" class="bfd-circle technical"></circle>
                <text x="40" y="95" class="bfd-text">Technical capability</text>
                <circle r="5" cx="15" cy="110" class="bfd-circle outcome"></circle>
                <text x="40" y="115" class="bfd-text outcome-text">Outcome</text>
                <circle r="5" cx="15" cy="130" class="bfd-circle transparent"></circle>
                <text x="40" y="135" class="bfd-text">Multiple constructs</text>
                <text x="11.7" y="134" class="plus">+</text>
                <path id="key-link" class="link" d="M0 150 l20 0 m15 0" marker-end="url(#arrow)"></path>
                <text x="40" y="155" class="bfd-text">Predictive relationship</text>
            </svg>
            <div id="modal" class="glue-modal" role="dialog" aria-modal="true" aria-labelledby="modal-label"
                aria-describedby="modal-content">
                <div class="wrapper">
                    <h2 id="modal-label" class="glue-headline glue-headline--one"></h2>
                    <div id="modal-content" class="glue-mod-mt-std"></div>
                    <p class="modal-close-wrapper">
                        <button id="modal-close" class="glue-button h-c-button--secondary modal-close">Close</button>
                    </p>
                    <button class="glue-modal__close-btn"></button>
                </div>
            </div>
            <script src="https://www.gstatic.com/external_hosted/hammerjs/v2_0_2/hammer.min.js"></script>
            <script src="https://www.gstatic.com/glue/v21_0/glue-vanilla.min.js"></script>

            <div style="text-align:center"><a href="/pdf/big_friendly_diagram.pdf" target="_blank">
                <button>View PDF</button></a>
            </div>

</section>
</div>
</section>
{{ end }}